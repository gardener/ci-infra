apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

generatorOptions:
  disableNameSuffixHash: true

bases:
- ../base-prow

resources:
- grafana-ingress.yaml
- prow_prometheusrule.yaml

patchesStrategicMerge:
- grafana-deployment.yaml

secretGenerator:
- name: prometheus-prow-additional-scrape-configs
  namespace: monitoring
  options:
    labels:
      app.kubernetes.io/component: prometheus
      app.kubernetes.io/instance: k8s
      app.kubernetes.io/name: prometheus
      app.kubernetes.io/part-of: kube-prometheus
  files:
  - prometheus/additional-scrape-targets.yaml
- name: alertmanager-main
  namespace: monitoring
  behavior: merge
  files:
  - alertmanager.yaml=alertmanager/config.yaml
  - alertmanager/slack-messages.tmpl
